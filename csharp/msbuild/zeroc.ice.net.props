<?xml version="1.0" encoding="utf-8"?>
<!-- Copyright (c) ZeroC, Inc. All rights reserved. -->
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <PropertyGroup>
        <IceVersion>3.7.11</IceVersion>
        <IceIntVersion>30711</IceIntVersion>
        <IceVersionMM>3.7</IceVersionMM>
        <IceSoVersion>37</IceSoVersion>
        <IceHome>$(MSBuildThisFileDirectory)..</IceHome>
    </PropertyGroup>

    <Choose>
        <When Condition="'$(IceToolsPath)' == ''">
            <Choose>
                <!-- Platform-specific tools from NuGet package -->
                <When Condition="'$(OS)' == 'Windows_NT'">
                    <PropertyGroup>
                        <IceToolsPath>$(IceHome)\tools\windows-x64</IceToolsPath>
                    </PropertyGroup>
                </When>
                <When Condition="$([MSBuild]::IsOSPlatform('OSX'))">
                    <PropertyGroup>
                        <IceToolsPath>$(IceHome)/tools/macos-arm64</IceToolsPath>
                    </PropertyGroup>
                </When>
                <When Condition="$([MSBuild]::IsOSPlatform('Linux')) and '$([System.Runtime.InteropServices.RuntimeInformation]::OSArchitecture)' == 'Arm64'">
                    <PropertyGroup>
                        <IceToolsPath>$(IceHome)/tools/linux-arm64</IceToolsPath>
                    </PropertyGroup>
                </When>
                <When Condition="$([MSBuild]::IsOSPlatform('Linux'))">
                    <PropertyGroup>
                        <IceToolsPath>$(IceHome)/tools/linux-x64</IceToolsPath>
                    </PropertyGroup>
                </When>
                <!-- Fallback to system-installed slice2cs -->
                <When Condition="Exists('/usr/bin/slice2cs')">
                    <PropertyGroup>
                        <IceToolsPath>/usr/bin</IceToolsPath>
                    </PropertyGroup>
                </When>
                <When Condition="Exists('/usr/local/bin/slice2cs')">
                    <PropertyGroup>
                        <IceToolsPath>/usr/local/bin</IceToolsPath>
                    </PropertyGroup>
                </When>
                <When Condition="Exists('/opt/homebrew/bin/slice2cs')">
                    <PropertyGroup>
                        <IceToolsPath>/opt/homebrew/bin</IceToolsPath>
                    </PropertyGroup>
                </When>
            </Choose>
        </When>
    </Choose>
</Project>
