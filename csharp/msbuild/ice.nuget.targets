<Project DefaultTargets="NugetPack" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <PropertyGroup>
        <IceSrcRootDir>$(MSBuildThisFileDirectory)..\</IceSrcRootDir>
    </PropertyGroup>

    <ItemGroup>
        <!-- .NET assemblies and tools -->
        <NetIceBox Include="$(IceSrcRootDir)bin\net8.0\publish\*"
                   Exclude="$(IceSrcRootDir)bin\net8.0\publish\*.exe" />
        <NetFrameworkIceBox Include="$(IceSrcRootDir)bin\net472\publish\*"
                            Condition="'$(OS)' == 'Windows_NT'" />

        <Assemblies Include="$(IceSrcRootDir)lib\netstandard2.0\*.dll;
                             $(IceSrcRootDir)lib\netstandard2.0\*.xml;
                             $(IceSrcRootDir)lib\netstandard2.0\*.pdb"/>

        <Slices Include="$(IceSrcRootDir)..\slice\**\*.ice"
                Exclude="$(IceSrcRootDir)..\slice\IceDiscovery\*.ice;
                         $(IceSrcRootDir)..\slice\IceLocatorDiscovery\*.ice"/>
    </ItemGroup>

    <!-- Copy required files to the package specific directories -->
    <Target Name="NugetPack">
        <Copy SourceFiles="@(Assemblies)" DestinationFolder="$(PackageDirectory)\lib\netstandard2.0"/>
        <Copy SourceFiles="@(Slices)" DestinationFolder="$(PackageDirectory)\slice\%(Slices.RecursiveDir)"/>
        <Copy SourceFiles="@(NetIceBox)" DestinationFolder="$(PackageDirectory)\tools\net8.0"/>
        <Copy SourceFiles="@(NetFrameworkIceBox)" DestinationFolder="$(PackageDirectory)\tools\net472"/>
    </Target>
</Project>
