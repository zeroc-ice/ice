name: "Dispatch Workflow"
description: "Trigger a workflow_dispatch on a given ref"
inputs:
  ref:
    description: "Git ref to dispatch"
    required: true
  workflow:
    description: "Workflow filename to dispatch"
    required: true
  token:
    description: "GitHub token with workflow scope"
    required: true
runs:
  using: "composite"
  steps:
    - name: Dispatch workflow
      run: |
        set -euo pipefail
        echo "Dispatching ${WORKFLOW} on ref ${REF}"
        gh workflow run "${WORKFLOW}" --ref "${REF}"
      env:
        GH_TOKEN: ${{ inputs.token }}
        REF: ${{ inputs.ref }}
        WORKFLOW: ${{ inputs.workflow }}
      shell: bash
