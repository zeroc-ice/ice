<?xml version="1.0" encoding="utf-8"?>
<!-- Copyright (c) 2009-2018 ZeroC, Inc. All rights reserved. -->
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <!-- default values -->
    <Choose>
        <When Condition="Exists('$(MSBuildThisFileDirectory)..\tools\slice2cpp.exe')">
            <!-- Use the Slice compiler from this NuGet package -->
            <PropertyGroup>
                <IceToolsPath>$(MSBuildThisFileDirectory)..\tools\</IceToolsPath>

                <!-- AssemblyTaskFactory is the default value when no TaskFactory is specified -->
                <SliceToolsTaskFactory>AssemblyTaskFactory</SliceToolsTaskFactory>
            </PropertyGroup>
        </When>
        <Otherwise>
            <PropertyGroup >
                <!-- Use the Slice compiler from this Source distribution -->
                <IceToolsPath>$(MSBuildThisFileDirectory)..\..\..\cpp\bin\x64\$(Configuration)</IceToolsPath>

                <!-- Force task to run out of process to avoid issues with files in use -->
                <SliceToolsTaskFactory>TaskHostFactory</SliceToolsTaskFactory>
            </PropertyGroup>
        </Otherwise>
    </Choose>

    <ItemDefinitionGroup>
        <SliceCompile>
            <OutputDir>$(IntDir)</OutputDir>
            <HeaderExt>h</HeaderExt>
            <SourceExt>cpp</SourceExt>
        </SliceCompile>
    </ItemDefinitionGroup>

    <Choose>
        <When Condition="Exists('$(MSBuildThisFileDirectory)..\tools\slice2cpp.exe')">
            <!-- Default SliceCompile settings for NuGet package -->
            <ItemDefinitionGroup>
                <SliceCompile>
                    <IncludeDirectories>$(MSBuildThisFileDirectory)..\slice</IncludeDirectories>
                </SliceCompile>
            </ItemDefinitionGroup>
        </When>
        <Otherwise>
            <!-- Default SliceCompile settings for Ice source builds -->
            <ItemDefinitionGroup>
                <SliceCompile>
                    <IncludeDirectories>$(MSBuildThisFileDirectory)..\..\..\slice</IncludeDirectories>
                </SliceCompile>
            </ItemDefinitionGroup>
        </Otherwise>
    </Choose>
</Project>
